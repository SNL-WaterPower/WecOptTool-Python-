<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tutorial 1 - WaveBot &mdash; WecOptTool 1.1.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Tutorial 2 - WaveBot Optimization" href="tutorial_2_wavebot_optimization.html" />
    <link rel="prev" title="Tutorials" href="../tutorials.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> WecOptTool
          </a>
              <div class="version">
                1.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../theory.html">Theory &amp; Practice</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Tutorial 1 - WaveBot</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Problem-setup">Problem setup</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#WEC-object">WEC object</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Waves">Waves</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Objective-function">Objective function</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Solve">Solve</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Results">Results</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Plotting-with-xarray">Plotting with xarray</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Plotting-Continuous-Time">Plotting Continuous Time</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Comparison-to-unconstrained-case">Comparison to unconstrained case</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_2_wavebot_optimization.html">Tutorial 2 - WaveBot Optimization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source_code.html">API Documentation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">WecOptTool</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../tutorials.html">Tutorials</a> &raquo;</li>
      <li>Tutorial 1 - WaveBot</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/_examples/tutorial_1_wavebot.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="Tutorial-1---WaveBot">
<h1>Tutorial 1 - WaveBot<a class="headerlink" href="#Tutorial-1---WaveBot" title="Permalink to this headline"></a></h1>
<p>The goal of this tutorial is to show a simple example of the inner optimization loop in WecOptTool. It uses a one-body WEC, the WaveBot, in one degree of freedom in regular waves. The goal is to <strong>find the optimal PTO force time-series</strong> that produce the most energy subject to a maximum force the PTO can excert.</p>
<img alt="WaveBot Photo" src="https://live.staticflickr.com/65535/51855905347_de87ccaaba_z.jpg" />
<p>We will start by loading the necessary modules and creating a save directory:</p>
<ul class="simple">
<li><p>Set the <a class="reference external" href="https://docs.python.org/3/library/logging.html#levels">logging level</a> (optional) to control the amount of information printed to the screen</p></li>
<li><p>Import Autograd (wrapper on NumPy, required) for automatic differentiation</p></li>
<li><p>Import other packages we will use in this tutorial</p></li>
<li><p>Import WecOptTool</p></li>
<li><p>Create the <em>save</em> directory if it doesn’t exist</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># logging</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>

<span class="c1"># autograd (derivatives)</span>
<span class="kn">import</span> <span class="nn">autograd.numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">autograd.builtins</span> <span class="kn">import</span> <span class="nb">isinstance</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">dict</span>

<span class="c1"># other packages</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">capytaine</span> <span class="k">as</span> <span class="nn">cpy</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># wecopttool</span>
<span class="kn">import</span> <span class="nn">wecopttool</span> <span class="k">as</span> <span class="nn">wot</span>

<span class="c1"># create save directory</span>
<span class="n">results_dir</span> <span class="o">=</span> <span class="s1">&#39;results_tutorial_1&#39;</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">results_dir</span><span class="p">):</span>
  <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">results_dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="Problem-setup">
<h2>Problem setup<a class="headerlink" href="#Problem-setup" title="Permalink to this headline"></a></h2>
<p>The problem is defined in three parts: the WEC object, the wave spectrum, and the objective function that we are optimizing for.</p>
<section id="WEC-object">
<h3>WEC object<a class="headerlink" href="#WEC-object" title="Permalink to this headline"></a></h3>
<p>In this section we will create the <code class="docutils literal notranslate"><span class="pre">WEC</span></code> object, which contains all the information about the WEC and its dynamics. This includes the mesh, degrees of freedom, mass and hydrostatic properties, linear hydrodynamic coefficients (from a BEM solution), additional dynamic forces (e.g. PTO force, mooring, non-linear hydrodynamics), and constraints (e.g. maximum PTO extension). In this case, the only additional force will be the PTO force and the only constraint will be a maximum PTO force of
<span class="math notranslate nohighlight">\(2000 N\)</span>. Note that the BEM solution is not required when creating the WEC object, it can be calculated or read after the WEC is created. WecOptTool uses Capytaine as a BEM solver, and one of the first things we will do is create a Capytaine FloatingBody.</p>
<p>First, we will create a surface mesh for the hull using an existing function (note, you can use existing STL files, etc.).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wb</span> <span class="o">=</span> <span class="n">wot</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">WaveBot</span><span class="p">()</span>  <span class="c1"># use standard dimensions</span>
<span class="n">mesh_size_factor</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="c1"># 1.0 for default, smaller to refine mesh</span>
<span class="n">mesh</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">mesh</span><span class="p">(</span><span class="n">mesh_size_factor</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>From this mesh, we can create a Capytaine floating body, which captures both the mesh and degrees of freedom. We will only model the HEAVE degree of freedom in this case.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fb</span> <span class="o">=</span> <span class="n">cpy</span><span class="o">.</span><span class="n">FloatingBody</span><span class="o">.</span><span class="n">from_meshio</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;WaveBot&quot;</span><span class="p">)</span>
<span class="n">fb</span><span class="o">.</span><span class="n">add_translation_dof</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;HEAVE&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO:capytaine.bodies.bodies:Stored 1054 triangle faces as quadrilaterals
INFO:capytaine.bodies.bodies:New floating body: WaveBot.
</pre></div></div>
</div>
<div class="line-block">
<div class="line">At this point we can visualize the mesh for inspection. Capytaine has built-in methods for visualizing meshes (<code class="docutils literal notranslate"><span class="pre">fb.show</span></code>, and <code class="docutils literal notranslate"><span class="pre">fb.show_matplotlib</span></code>). When running outside a Notebook, these are interactive.</div>
<div class="line">The included WaveBot example also has a method for plotting the cross-section of the device.</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fb</span><span class="o">.</span><span class="n">show_matplotlib</span><span class="p">()</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">plot_cross_section</span><span class="p">(</span><span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># specific to WaveBot</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/_examples_tutorial_1_wavebot_7_0.png" src="../_images/_examples_tutorial_1_wavebot_7_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/_examples_tutorial_1_wavebot_7_1.png" src="../_images/_examples_tutorial_1_wavebot_7_1.png" />
</div>
</div>
<p>Next we will add the mass and hydrostatic properties. If these values are known they can be added directly. H Here we will use the fact that the WaveBot is free floating and assume constant density to calculate these properties. Capytaine does not (yet) natively perform hydrostatic calculations. We can use <code class="docutils literal notranslate"><span class="pre">meshmagick</span></code> to do this, which has been wrapped for convenience in <code class="docutils literal notranslate"><span class="pre">wecopttool.hydrostatics</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hs_data</span> <span class="o">=</span> <span class="n">wot</span><span class="o">.</span><span class="n">hydrostatics</span><span class="o">.</span><span class="n">hydrostatics</span><span class="p">(</span><span class="n">fb</span><span class="p">)</span>
<span class="n">mass_33</span> <span class="o">=</span> <span class="n">wot</span><span class="o">.</span><span class="n">hydrostatics</span><span class="o">.</span><span class="n">mass_matrix_constant_density</span><span class="p">(</span><span class="n">hs_data</span><span class="p">)[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">mass</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">mass_33</span><span class="p">)</span>
<span class="n">stiffness_33</span> <span class="o">=</span> <span class="n">wot</span><span class="o">.</span><span class="n">hydrostatics</span><span class="o">.</span><span class="n">stiffness_matrix</span><span class="p">(</span><span class="n">hs_data</span><span class="p">)[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">stiffness</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">stiffness_33</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Next, we will define the frequencies to be considered for the pseudo-spectral problem. We will use 50 frequencies with a spacing of 0.05 Hz. These frequencies will be used for the Fourier representation of both the wave (and wave excitation force, BEM) and the desired PTO force. See the Theory section of the Documentation for more details on the pseudo-spectral problem formulation.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f0</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">nfreq</span> <span class="o">=</span> <span class="mi">50</span>
</pre></div>
</div>
</div>
<p>In general, the optimization state and objective function can be anything of interest, and the additional dynamic forces and constraint are also arbitrary. In this case the optimization state is the PTO force time-history (Fourier representation), the PTO force will be used as an additional force in the dynamics and will be constrained, and the average PTO power will be the optimization objective function. WecOptTool includes these functions for this specific case in the <code class="docutils literal notranslate"><span class="pre">wecopttool.pto</span></code>
submodule. For different optimization state, objective function, dynamic forces, and constraints you will have to write your own function.</p>
<p>In this case all the functions of interest are packaged into a class called <code class="docutils literal notranslate"><span class="pre">PseudoSpectralPTO</span></code>. We will start by creating an instance of this class which requires the number of frequencies in the pseudo-spectral problem and a <code class="docutils literal notranslate"><span class="pre">kinematics</span></code> matrix. The kinematics matrix converts from the WEC degrees of freedom (in this case only heave) to the PTO degrees of freedom. In this case the PTO extracts power directly from the WEC’s heave so the kinematics matrix is simply the <span class="math notranslate nohighlight">\(1\times 1\)</span>
identity matrix.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kinematics</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">fb</span><span class="o">.</span><span class="n">nb_dofs</span><span class="p">)</span>
<span class="n">pto</span> <span class="o">=</span> <span class="n">wot</span><span class="o">.</span><span class="n">pto</span><span class="o">.</span><span class="n">PseudoSpectralPTO</span><span class="p">(</span><span class="n">nfreq</span><span class="p">,</span> <span class="n">kinematics</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Next we will create the constraints, which must be in the correct format for <code class="docutils literal notranslate"><span class="pre">`scipy.optimize.minimize()</span></code> &lt;<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html">https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html</a>&gt;`__. We will constraint the PTO force to <span class="math notranslate nohighlight">\(2000 N\)</span> in either direction. We will enforce the constraint at 4 times more points than the dynamics (see theory section for why this is helpful for the pseudo-spectral problem). This will be the only constraint.</p>
<p>We will also create the additional dynamics forces function, which will simply be the PTO force.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># constraints</span>
<span class="n">f_max</span> <span class="o">=</span> <span class="mf">2000.0</span>
<span class="n">nsubsteps</span> <span class="o">=</span> <span class="mi">4</span>


<span class="k">def</span> <span class="nf">const_f_pto</span><span class="p">(</span><span class="n">wec</span><span class="p">,</span> <span class="n">x_wec</span><span class="p">,</span> <span class="n">x_opt</span><span class="p">):</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">pto</span><span class="o">.</span><span class="n">force_on_wec</span><span class="p">(</span><span class="n">wec</span><span class="p">,</span> <span class="n">x_wec</span><span class="p">,</span> <span class="n">x_opt</span><span class="p">,</span> <span class="n">nsubsteps</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">f_max</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>


<span class="n">ineq_cons</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;ineq&#39;</span><span class="p">,</span>
             <span class="s1">&#39;fun&#39;</span><span class="p">:</span> <span class="n">const_f_pto</span><span class="p">,</span>
             <span class="p">}</span>
<span class="n">constraints</span> <span class="o">=</span> <span class="p">[</span><span class="n">ineq_cons</span><span class="p">]</span>

<span class="c1"># additional dynamics forces function</span>
<span class="n">f_add</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;PTO force&#39;</span><span class="p">:</span> <span class="n">pto</span><span class="o">.</span><span class="n">force_on_wec</span><span class="p">}</span>
</pre></div>
</div>
</div>
<p>We are now ready to create the WEC object!</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wec</span> <span class="o">=</span> <span class="n">wot</span><span class="o">.</span><span class="n">WEC</span><span class="p">(</span><span class="n">fb</span><span class="p">,</span> <span class="n">mass</span><span class="p">,</span> <span class="n">stiffness</span><span class="p">,</span> <span class="n">f0</span><span class="p">,</span> <span class="n">nfreq</span><span class="p">,</span>
              <span class="n">f_add</span><span class="o">=</span><span class="n">f_add</span><span class="p">,</span> <span class="n">constraints</span><span class="o">=</span><span class="n">constraints</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO:wecopttool.core:Changing value of &#39;f_add&#39;. This might cause some attributes to be reset.
INFO:wecopttool.core:New WEC: WaveBot with 1 DOF.
</pre></div></div>
</div>
<p>Finally, we will now calculate the BEM coefficients by running Capytaine. If you have already ran the BEM the results will be read instead. We can review the results by plotting the impedance.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">results_dir</span><span class="p">,</span> <span class="s1">&#39;bem.nc&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">fname</span><span class="p">):</span>
    <span class="n">wec</span><span class="o">.</span><span class="n">read_bem</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">wec</span><span class="o">.</span><span class="n">run_bem</span><span class="p">()</span>
    <span class="n">wec</span><span class="o">.</span><span class="n">write_bem</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">wec</span><span class="o">.</span><span class="n">plot_impedance</span><span class="p">()</span>  <span class="c1"># see function doc for options</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO:wecopttool.core:Running Capytaine (BEM): 50 frequencies x 1 wave directions.
INFO:capytaine.bodies.bodies:Clipping WaveBot_immersed with respect to Plane(normal=[0. 0. 1.], point=[0. 0. 0.])
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=0.314, depth=inf, wave_direction=0.000, rho=1025.0).
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=0.314, depth=inf, radiating_dof=HEAVE, rho=1025.0).
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=0.628, depth=inf, wave_direction=0.000, rho=1025.0).
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=0.628, depth=inf, radiating_dof=HEAVE, rho=1025.0).
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=0.942, depth=inf, wave_direction=0.000, rho=1025.0).
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=0.942, depth=inf, radiating_dof=HEAVE, rho=1025.0).
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=1.257, depth=inf, wave_direction=0.000, rho=1025.0).
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=1.257, depth=inf, radiating_dof=HEAVE, rho=1025.0).
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=1.571, depth=inf, wave_direction=0.000, rho=1025.0).
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=1.571, depth=inf, radiating_dof=HEAVE, rho=1025.0).
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=1.885, depth=inf, wave_direction=0.000, rho=1025.0).
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=1.885, depth=inf, radiating_dof=HEAVE, rho=1025.0).
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=2.199, depth=inf, wave_direction=0.000, rho=1025.0).
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=2.199, depth=inf, radiating_dof=HEAVE, rho=1025.0).
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=2.513, depth=inf, wave_direction=0.000, rho=1025.0).
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=2.513, depth=inf, radiating_dof=HEAVE, rho=1025.0).
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=2.827, depth=inf, wave_direction=0.000, rho=1025.0).
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=2.827, depth=inf, radiating_dof=HEAVE, rho=1025.0).
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=3.142, depth=inf, wave_direction=0.000, rho=1025.0).
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=3.142, depth=inf, radiating_dof=HEAVE, rho=1025.0).
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=3.456, depth=inf, wave_direction=0.000, rho=1025.0).
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=3.456, depth=inf, radiating_dof=HEAVE, rho=1025.0).
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=3.770, depth=inf, wave_direction=0.000, rho=1025.0).
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=3.770, depth=inf, radiating_dof=HEAVE, rho=1025.0).
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=4.084, depth=inf, wave_direction=0.000, rho=1025.0).
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=4.084, depth=inf, radiating_dof=HEAVE, rho=1025.0).
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=4.398, depth=inf, wave_direction=0.000, rho=1025.0).
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=4.398, depth=inf, radiating_dof=HEAVE, rho=1025.0).
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=4.712, depth=inf, wave_direction=0.000, rho=1025.0).
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=4.712, depth=inf, radiating_dof=HEAVE, rho=1025.0).
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=5.027, depth=inf, wave_direction=0.000, rho=1025.0).
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=5.027, depth=inf, radiating_dof=HEAVE, rho=1025.0).
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=5.341, depth=inf, wave_direction=0.000, rho=1025.0).
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=5.341, depth=inf, radiating_dof=HEAVE, rho=1025.0).
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=5.655, depth=inf, wave_direction=0.000, rho=1025.0).
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=5.655, depth=inf, radiating_dof=HEAVE, rho=1025.0).
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=5.969, depth=inf, wave_direction=0.000, rho=1025.0).
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=5.969, depth=inf, radiating_dof=HEAVE, rho=1025.0).
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=6.283, depth=inf, wave_direction=0.000, rho=1025.0).
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=6.283, depth=inf, radiating_dof=HEAVE, rho=1025.0).
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=6.597, depth=inf, wave_direction=0.000, rho=1025.0).
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=6.597, depth=inf, radiating_dof=HEAVE, rho=1025.0).
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=6.912, depth=inf, wave_direction=0.000, rho=1025.0).
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=6.912, depth=inf, radiating_dof=HEAVE, rho=1025.0).
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=7.226, depth=inf, wave_direction=0.000, rho=1025.0).
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=7.226, depth=inf, radiating_dof=HEAVE, rho=1025.0).
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=7.540, depth=inf, wave_direction=0.000, rho=1025.0).
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=7.540, depth=inf, radiating_dof=HEAVE, rho=1025.0).
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=7.854, depth=inf, wave_direction=0.000, rho=1025.0).
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=7.854, depth=inf, radiating_dof=HEAVE, rho=1025.0).
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=8.168, depth=inf, wave_direction=0.000, rho=1025.0).
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=8.168, depth=inf, radiating_dof=HEAVE, rho=1025.0).
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=8.482, depth=inf, wave_direction=0.000, rho=1025.0).
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=8.482, depth=inf, radiating_dof=HEAVE, rho=1025.0).
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=8.796, depth=inf, wave_direction=0.000, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=7.97e-01)!
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=8.796, depth=inf, radiating_dof=HEAVE, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=7.97e-01)!
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=9.111, depth=inf, wave_direction=0.000, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=7.43e-01)!
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=9.111, depth=inf, radiating_dof=HEAVE, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=7.43e-01)!
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=9.425, depth=inf, wave_direction=0.000, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=6.94e-01)!
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=9.425, depth=inf, radiating_dof=HEAVE, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=6.94e-01)!
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=9.739, depth=inf, wave_direction=0.000, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=6.50e-01)!
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=9.739, depth=inf, radiating_dof=HEAVE, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=6.50e-01)!
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=10.053, depth=inf, wave_direction=0.000, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=6.10e-01)!
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=10.053, depth=inf, radiating_dof=HEAVE, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=6.10e-01)!
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=10.367, depth=inf, wave_direction=0.000, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=5.73e-01)!
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=10.367, depth=inf, radiating_dof=HEAVE, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=5.73e-01)!
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=10.681, depth=inf, wave_direction=0.000, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=5.40e-01)!
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=10.681, depth=inf, radiating_dof=HEAVE, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=5.40e-01)!
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=10.996, depth=inf, wave_direction=0.000, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=5.10e-01)!
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=10.996, depth=inf, radiating_dof=HEAVE, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=5.10e-01)!
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=11.310, depth=inf, wave_direction=0.000, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=4.82e-01)!
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=11.310, depth=inf, radiating_dof=HEAVE, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=4.82e-01)!
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=11.624, depth=inf, wave_direction=0.000, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=4.56e-01)!
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=11.624, depth=inf, radiating_dof=HEAVE, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=4.56e-01)!
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=11.938, depth=inf, wave_direction=0.000, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=4.32e-01)!
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=11.938, depth=inf, radiating_dof=HEAVE, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=4.32e-01)!
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=12.252, depth=inf, wave_direction=0.000, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=4.11e-01)!
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=12.252, depth=inf, radiating_dof=HEAVE, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=4.11e-01)!
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=12.566, depth=inf, wave_direction=0.000, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=3.90e-01)!
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=12.566, depth=inf, radiating_dof=HEAVE, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=3.90e-01)!
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=12.881, depth=inf, wave_direction=0.000, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=3.72e-01)!
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=12.881, depth=inf, radiating_dof=HEAVE, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=3.72e-01)!
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=13.195, depth=inf, wave_direction=0.000, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=3.54e-01)!
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=13.195, depth=inf, radiating_dof=HEAVE, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=3.54e-01)!
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=13.509, depth=inf, wave_direction=0.000, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=3.38e-01)!
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=13.509, depth=inf, radiating_dof=HEAVE, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=3.38e-01)!
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=13.823, depth=inf, wave_direction=0.000, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=3.23e-01)!
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=13.823, depth=inf, radiating_dof=HEAVE, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=3.23e-01)!
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=14.137, depth=inf, wave_direction=0.000, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=3.08e-01)!
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=14.137, depth=inf, radiating_dof=HEAVE, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=3.08e-01)!
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=14.451, depth=inf, wave_direction=0.000, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=2.95e-01)!
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=14.451, depth=inf, radiating_dof=HEAVE, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=2.95e-01)!
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=14.765, depth=inf, wave_direction=0.000, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=2.83e-01)!
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=14.765, depth=inf, radiating_dof=HEAVE, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=2.83e-01)!
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=15.080, depth=inf, wave_direction=0.000, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=2.71e-01)!
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=15.080, depth=inf, radiating_dof=HEAVE, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=2.71e-01)!
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=15.394, depth=inf, wave_direction=0.000, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=2.60e-01)!
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=15.394, depth=inf, radiating_dof=HEAVE, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=2.60e-01)!
INFO:capytaine.bem.solver:Solve DiffractionProblem(body=WaveBot_immersed, omega=15.708, depth=inf, wave_direction=0.000, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=2.50e-01)!
INFO:capytaine.bem.solver:Solve RadiationProblem(body=WaveBot_immersed, omega=15.708, depth=inf, radiating_dof=HEAVE, rho=1025.0).
WARNING:capytaine.bem.solver:Resolution of the mesh (8×max_radius=8.06e-01) might be insufficient for this wavelength (wavelength=2.50e-01)!
INFO:wecopttool.core:Impedance matrix deleted. To calculate impedance call &#39;self.bem_calc_impedance()&#39;
INFO:wecopttool.core:Impedance matrix deleted. To calculate impedance call &#39;self.bem_calc_impedance()&#39;
INFO:wecopttool.core:Calculating impedance matrix.
INFO:capytaine.post_pro.impedance:Compute impedance.
WARNING:wecopttool.core:Linear damping for DOF &#34;HEAVE&#34; has negative or close to zero terms. Shifting up.
INFO:wecopttool.core:Writting BEM data to results_tutorial_1/bem.nc.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/_examples_tutorial_1_wavebot_19_1.png" src="../_images/_examples_tutorial_1_wavebot_19_1.png" />
</div>
</div>
</section>
<section id="Waves">
<h3>Waves<a class="headerlink" href="#Waves" title="Permalink to this headline"></a></h3>
<p>The wave environment must be specified as an <code class="docutils literal notranslate"><span class="pre">xarray.Dataset</span></code> containing two 2-dimensional <code class="docutils literal notranslate"><span class="pre">xarray.DataArray</span></code>: (1) the amplitude spectrum magnitude <code class="docutils literal notranslate"><span class="pre">S</span></code> (m^2*s) and (2) the phase <code class="docutils literal notranslate"><span class="pre">phase</span></code> (rad). The two coordinates are the wave frequency <code class="docutils literal notranslate"><span class="pre">omega</span></code> (rad/s) and the direction <code class="docutils literal notranslate"><span class="pre">wave_direction</span></code> (rad). The <code class="docutils literal notranslate"><span class="pre">wecopttool.waves</span></code> submodule contains functions for creating this <code class="docutils literal notranslate"><span class="pre">xarray.Dataset</span></code> for different types of wave environments.</p>
<p>In this case we will use a regular wave with a frequency of 0.3 Hz and an amplitude of 0.0625 m. We will use the <code class="docutils literal notranslate"><span class="pre">wecopttool.waves.regular_wave</span></code> function.</p>
<p>Now we may create a regular wave using the <code class="docutils literal notranslate"><span class="pre">wecopttool.waves</span></code> submodule. In this case, we will use a wave with a frequency of 0.3 Hz and an amplitude of 0.0625 m.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wfreq</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">amplitude</span> <span class="o">=</span> <span class="mf">0.0625</span>
<span class="n">phase</span> <span class="o">=</span> <span class="o">-</span><span class="mi">40</span>
<span class="n">waves</span> <span class="o">=</span> <span class="n">wot</span><span class="o">.</span><span class="n">waves</span><span class="o">.</span><span class="n">regular_wave</span><span class="p">(</span><span class="n">f0</span><span class="p">,</span> <span class="n">nfreq</span><span class="p">,</span> <span class="n">wfreq</span><span class="p">,</span> <span class="n">amplitude</span><span class="p">,</span> <span class="n">phase</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Objective-function">
<h3>Objective function<a class="headerlink" href="#Objective-function" title="Permalink to this headline"></a></h3>
<p>The objective function is the quantity (scalar) we want to optimize. It is function of both the WEC dynamics state and the user-defined optimization state. We will need to give the solver the objective function to optimize and the size of the optimization state. In this case these are the average PTO power and the number of Fourier coefficients in the pseudo-spectral representation of the PTO force, respectively. We can get both of these from the PTO object we created.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obj_fun</span> <span class="o">=</span> <span class="n">pto</span><span class="o">.</span><span class="n">average_power</span>
<span class="n">nstate_opt</span> <span class="o">=</span> <span class="n">pto</span><span class="o">.</span><span class="n">nstate</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="Solve">
<h2>Solve<a class="headerlink" href="#Solve" title="Permalink to this headline"></a></h2>
<p>Now we can solve for the optimal PTO force, subject to the dynamics and our additional constraint (no more than <span class="math notranslate nohighlight">\(2000 N\)</span> force). WecOptTool will solve the optimization problem (PTO force that will produce the highest average power) while simultaneously ensuring the dynamics equation is satisfied.</p>
<p>To help the optimization we will scale the problem before solving it (see Documentation). WecOptTool allows you to scale the WEC dynamics state (see Documentation), your optimization state (in this case the Fourier coefficients for the PTO force), and the objective function separately. See the <code class="docutils literal notranslate"><span class="pre">wecopttool.WEC.solve()</span></code> function for more information.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scale_x_wec</span> <span class="o">=</span> <span class="mf">1e1</span>
<span class="n">scale_x_opt</span> <span class="o">=</span> <span class="mf">1e-3</span>
<span class="n">scale_obj</span> <span class="o">=</span> <span class="mf">1e-2</span>
</pre></div>
</div>
</div>
<p>We are now ready to solve the problem. Note that we can pass additional options to the optimizer. For more details see <code class="docutils literal notranslate"><span class="pre">scipy.optimize.minimize</span></code>. Also note that the only required inputs for defining and solving the problem are: (1) the waves, (2) the objective function, and (3) the size of the optimization state. All other inputs are used to control the optimization execution. Pay attention to the <code class="docutils literal notranslate"><span class="pre">Exit</span> <span class="pre">mode</span></code>: an exit mode of <span class="math notranslate nohighlight">\(0\)</span> indicates a successful solution. See
<code class="docutils literal notranslate"><span class="pre">scipy.optimize.minimize</span></code> for more information.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">options</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;maxiter&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;ftol&#39;</span><span class="p">:</span> <span class="mf">1e-8</span><span class="p">}</span>

<span class="n">wec_tdom</span><span class="p">,</span> <span class="n">wec_fdom</span><span class="p">,</span> <span class="n">x_wec</span><span class="p">,</span> <span class="n">x_opt</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">res</span> <span class="o">=</span> <span class="n">wec</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span>
    <span class="n">waves</span><span class="p">,</span> <span class="n">obj_fun</span><span class="p">,</span> <span class="n">nstate_opt</span><span class="p">,</span> <span class="n">optim_options</span><span class="o">=</span><span class="n">options</span><span class="p">,</span>
    <span class="n">scale_x_wec</span><span class="o">=</span><span class="n">scale_x_wec</span><span class="p">,</span> <span class="n">scale_x_opt</span><span class="o">=</span><span class="n">scale_x_opt</span><span class="p">,</span> <span class="n">scale_obj</span><span class="o">=</span><span class="n">scale_obj</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO:wecopttool.core:Solving pseudo-spectral control problem.
INFO:wecopttool.core:[max(x_wec), max(x_opt), obj_fun(x)]: [3.52e+01, 4.85e+01, 2.80e+03]
INFO:wecopttool.core:[max(x_wec), max(x_opt), obj_fun(x)]: [7.22e-01, 7.53e-01, 2.37e+00]
INFO:wecopttool.core:[max(x_wec), max(x_opt), obj_fun(x)]: [6.20e-01, 5.36e-01, 1.14e-01]
INFO:wecopttool.core:[max(x_wec), max(x_opt), obj_fun(x)]: [7.11e-01, 4.73e-01, -2.54e-01]
INFO:wecopttool.core:[max(x_wec), max(x_opt), obj_fun(x)]: [8.69e-01, 7.62e-01, -5.13e-01]
INFO:wecopttool.core:[max(x_wec), max(x_opt), obj_fun(x)]: [1.10e+00, 1.36e+00, -8.18e-01]
INFO:wecopttool.core:[max(x_wec), max(x_opt), obj_fun(x)]: [1.20e+00, 1.65e+00, -9.55e-01]
INFO:wecopttool.core:[max(x_wec), max(x_opt), obj_fun(x)]: [1.23e+00, 1.77e+00, -1.00e+00]
INFO:wecopttool.core:[max(x_wec), max(x_opt), obj_fun(x)]: [1.24e+00, 1.82e+00, -1.01e+00]
INFO:wecopttool.core:[max(x_wec), max(x_opt), obj_fun(x)]: [1.24e+00, 1.88e+00, -1.03e+00]
INFO:wecopttool.core:[max(x_wec), max(x_opt), obj_fun(x)]: [1.24e+00, 1.91e+00, -1.03e+00]
INFO:wecopttool.core:[max(x_wec), max(x_opt), obj_fun(x)]: [1.24e+00, 1.92e+00, -1.03e+00]
INFO:wecopttool.core:[max(x_wec), max(x_opt), obj_fun(x)]: [1.24e+00, 1.93e+00, -1.03e+00]
INFO:wecopttool.core:[max(x_wec), max(x_opt), obj_fun(x)]: [1.24e+00, 1.93e+00, -1.03e+00]
INFO:wecopttool.core:[max(x_wec), max(x_opt), obj_fun(x)]: [1.24e+00, 1.93e+00, -1.03e+00]
INFO:wecopttool.core:[max(x_wec), max(x_opt), obj_fun(x)]: [1.24e+00, 1.93e+00, -1.03e+00]
INFO:wecopttool.core:[max(x_wec), max(x_opt), obj_fun(x)]: [1.24e+00, 1.94e+00, -1.03e+00]
INFO:wecopttool.core:[max(x_wec), max(x_opt), obj_fun(x)]: [1.24e+00, 1.94e+00, -1.03e+00]
INFO:wecopttool.core:[max(x_wec), max(x_opt), obj_fun(x)]: [1.24e+00, 1.94e+00, -1.03e+00]
INFO:wecopttool.core:[max(x_wec), max(x_opt), obj_fun(x)]: [1.24e+00, 1.94e+00, -1.03e+00]
INFO:wecopttool.core:[max(x_wec), max(x_opt), obj_fun(x)]: [1.24e+00, 1.94e+00, -1.03e+00]
INFO:wecopttool.core:[max(x_wec), max(x_opt), obj_fun(x)]: [1.24e+00, 1.94e+00, -1.03e+00]
INFO:wecopttool.core:[max(x_wec), max(x_opt), obj_fun(x)]: [1.24e+00, 1.94e+00, -1.03e+00]
INFO:wecopttool.core:Optimization terminated successfully    (Exit mode 0)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Optimization terminated successfully    (Exit mode 0)
            Current function value: -1.031856239706403
            Iterations: 23
            Function evaluations: 23
            Gradient evaluations: 23
CPU times: user 11.6 s, sys: 1.93 s, total: 13.5 s
Wall time: 3.83 s
</pre></div></div>
</div>
<p>As a final step, we post-process the optimized PTO results. The included PTO class has a function to postprocess the raw optimized state (PTO force Fourier coefficients) to quantities of interest (e.g. force, power) in both the time- and frequency-domain as an <code class="docutils literal notranslate"><span class="pre">xarray.Dataset</span></code>. For different optimization states, you will have to do your own post-processing.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pto_tdom</span><span class="p">,</span> <span class="n">pto_fdom</span> <span class="o">=</span> <span class="n">pto</span><span class="o">.</span><span class="n">post_process</span><span class="p">(</span><span class="n">wec</span><span class="p">,</span> <span class="n">x_wec</span><span class="p">,</span> <span class="n">x_opt</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Results">
<h2>Results<a class="headerlink" href="#Results" title="Permalink to this headline"></a></h2>
<p>In this section we will save, view, and plot the results.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># print</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average power: </span><span class="si">{</span><span class="n">obj</span><span class="si">}</span><span class="s2"> W</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># save</span>
<span class="n">fname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">results_dir</span><span class="p">,</span> <span class="s1">&#39;wec_tdom.nc&#39;</span><span class="p">)</span>
<span class="n">wec_tdom</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>

<span class="n">fname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">results_dir</span><span class="p">,</span> <span class="s1">&#39;wec_fdom.nc&#39;</span><span class="p">)</span>
<span class="n">wot</span><span class="o">.</span><span class="n">complex_xarray_to_netcdf</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">wec_fdom</span><span class="p">)</span>

<span class="n">fname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">results_dir</span><span class="p">,</span> <span class="s1">&#39;pto_tdom.nc&#39;</span><span class="p">)</span>
<span class="n">pto_tdom</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>

<span class="n">fname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">results_dir</span><span class="p">,</span> <span class="s1">&#39;pto_fdom.nc&#39;</span><span class="p">)</span>
<span class="n">wot</span><span class="o">.</span><span class="n">complex_xarray_to_netcdf</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">pto_fdom</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Average power: -103.18562397064031 W

</pre></div></div>
</div>
<section id="Plotting-with-xarray">
<h3>Plotting with xarray<a class="headerlink" href="#Plotting-with-xarray" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">xarray</span></code> wrapper on <code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot.plot()</span></code> makes it easy to plot the results quickly. It sets labels and titles automatically based on the metadata stored in the array.</p>
<p>We will first look at some time-domain solutions. We will only plot a subset of the available quantities; inspect the <code class="docutils literal notranslate"><span class="pre">xarray.Dataset</span></code> objects for all stored quantities.</p>
<p>Note that the PTO force never exceeds <span class="math notranslate nohighlight">\(2000N\)</span>, and that due to the non-linear constraint the WEC heave motion is not sinusoidal.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">wec_tdom</span><span class="p">[</span><span class="s1">&#39;wave_elevation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">wec_tdom</span><span class="p">[</span><span class="s1">&#39;pos&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">pto_tdom</span><span class="p">[</span><span class="s1">&#39;force&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">pto_tdom</span><span class="p">[</span><span class="s1">&#39;power&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x169043220&gt;]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/_examples_tutorial_1_wavebot_33_1.png" src="../_images/_examples_tutorial_1_wavebot_33_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/_examples_tutorial_1_wavebot_33_2.png" src="../_images/_examples_tutorial_1_wavebot_33_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/_examples_tutorial_1_wavebot_33_3.png" src="../_images/_examples_tutorial_1_wavebot_33_3.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/_examples_tutorial_1_wavebot_33_4.png" src="../_images/_examples_tutorial_1_wavebot_33_4.png" />
</div>
</div>
<p>Next, we will look at some frequency-domain plots of the simulation results. Note that due to the non-linear constraint the PTO force contains higher frequencies, multiple of the excitation frequency. The unconstrained optimal solution would only contain one component at the excitation frequency.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fd_lines</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;marker&#39;</span><span class="p">:</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;linestyle&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;fillstyle&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">}</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">wec_fdom</span><span class="p">[</span><span class="s1">&#39;excitation_force&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">**</span><span class="n">fd_lines</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">pto_fdom</span><span class="p">[</span><span class="s1">&#39;force&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">**</span><span class="n">fd_lines</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/_examples_tutorial_1_wavebot_35_0.png" src="../_images/_examples_tutorial_1_wavebot_35_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/_examples_tutorial_1_wavebot_35_1.png" src="../_images/_examples_tutorial_1_wavebot_35_1.png" />
</div>
</div>
</section>
<section id="Plotting-Continuous-Time">
<h3>Plotting Continuous Time<a class="headerlink" href="#Plotting-Continuous-Time" title="Permalink to this headline"></a></h3>
<p>The pseudo-spectral method is a discrete-frequency but continuous time approach. The time-domain xarrays only contain the times corresponding to a inverse Fourier tranform of the complex amplitudes. This however might not be fine enough time discretization for plotting. We will now create more smooth plots.</p>
<p>First let’s plot the WEC position.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create the continuous time function</span>
<span class="n">pos</span> <span class="o">=</span> <span class="n">wec_fdom</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">influenced_dof</span><span class="o">=</span><span class="s2">&quot;HEAVE&quot;</span><span class="p">)</span>
<span class="n">fpos</span> <span class="o">=</span> <span class="n">wot</span><span class="o">.</span><span class="n">post_process_continuous_time</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>

<span class="c1"># fine time discretization</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>

<span class="c1"># plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">fpos</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time [s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;heave [m]&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;heave [m]&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/_examples_tutorial_1_wavebot_37_1.png" src="../_images/_examples_tutorial_1_wavebot_37_1.png" />
</div>
</div>
<p>Next, we will plot the PTO power, which looks very coarse when using the xarray results above. To calculate power in the time-domain we need to multiply the time-domain velocity and force.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create the continuous time functions</span>
<span class="n">vel</span> <span class="o">=</span> <span class="n">pto_fdom</span><span class="o">.</span><span class="n">vel</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">dof_pto</span><span class="o">=</span><span class="s2">&quot;pto_1&quot;</span><span class="p">)</span>
<span class="n">fvel</span> <span class="o">=</span> <span class="n">wot</span><span class="o">.</span><span class="n">post_process_continuous_time</span><span class="p">(</span><span class="n">vel</span><span class="p">)</span>

<span class="n">force</span> <span class="o">=</span> <span class="n">pto_fdom</span><span class="o">.</span><span class="n">force</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">dof_pto</span><span class="o">=</span><span class="s2">&quot;pto_1&quot;</span><span class="p">)</span>
<span class="n">fforce</span> <span class="o">=</span> <span class="n">wot</span><span class="o">.</span><span class="n">post_process_continuous_time</span><span class="p">(</span><span class="n">force</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">fpower</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">fvel</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">fforce</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

<span class="c1"># plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">fpower</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time [s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;power [W]&#39;</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;power [W]&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/_examples_tutorial_1_wavebot_39_1.png" src="../_images/_examples_tutorial_1_wavebot_39_1.png" />
</div>
</div>
</section>
</section>
<section id="Comparison-to-unconstrained-case">
<h2>Comparison to unconstrained case<a class="headerlink" href="#Comparison-to-unconstrained-case" title="Permalink to this headline"></a></h2>
<p>The unconstrained (no maximum PTO force) optimal control can be calculated analytically as the conjugate gradient of the intrinsic impedance. We will compare the two results to gain some insight into the effect of the constraint on the optimal PTO force.</p>
<p>We will look at comparisons in both the time- and frequency-domain. Note that the optimal constrained PTO force follows the optimal unconstrained solution (sinusoidal) whenever the unconstrained solution is within the constraint. When the constraint is active the optimal PTO force is the maximum PTO force of <span class="math notranslate nohighlight">\(2000 N\)</span>. Also note that the unconstrained optimal PTO force uses only one component at the excitation frequency, while the optimal constrained solution also contains components at odd
multiples of the excitation frequency.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">idof</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">Fe</span> <span class="o">=</span> <span class="n">wec_fdom</span><span class="p">[</span><span class="s1">&#39;excitation_force&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:,</span> <span class="n">idof</span><span class="p">]</span>
<span class="n">Zi</span> <span class="o">=</span> <span class="n">wec</span><span class="o">.</span><span class="n">hydro</span><span class="o">.</span><span class="n">Zi</span><span class="p">[:,</span> <span class="n">idof</span><span class="p">,</span> <span class="n">idof</span><span class="p">]</span>

<span class="n">cc_vel_fd</span> <span class="o">=</span> <span class="n">Fe</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Zi</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
<span class="n">cc_pos_fd</span> <span class="o">=</span> <span class="n">cc_vel_fd</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">cc_vel_fd</span><span class="o">.</span><span class="n">omega</span><span class="p">)</span>
<span class="n">cc_force_fd</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">Zi</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span> <span class="o">*</span> <span class="n">cc_vel_fd</span>

<span class="n">cc_pos_fd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">],</span> <span class="n">cc_pos_fd</span><span class="p">])</span>
<span class="n">cc_vel_fd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">],</span> <span class="n">cc_vel_fd</span><span class="p">])</span>
<span class="n">cc_force_fd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">],</span> <span class="n">cc_force_fd</span><span class="p">])</span>

<span class="n">cc_pos_td</span> <span class="o">=</span> <span class="n">wec</span><span class="o">.</span><span class="n">fd_to_td</span><span class="p">(</span><span class="n">cc_pos_fd</span><span class="p">)</span>
<span class="n">cc_vel_td</span> <span class="o">=</span> <span class="n">wec</span><span class="o">.</span><span class="n">fd_to_td</span><span class="p">(</span><span class="n">cc_vel_fd</span><span class="p">)</span>
<span class="n">cc_force_td</span> <span class="o">=</span> <span class="n">wec</span><span class="o">.</span><span class="n">fd_to_td</span><span class="p">(</span><span class="n">cc_force_fd</span><span class="p">)</span>

<span class="n">cc_power_td</span> <span class="o">=</span> <span class="n">cc_vel_td</span> <span class="o">*</span> <span class="n">cc_force_td</span>
<span class="n">cc_power_fd</span> <span class="o">=</span> <span class="n">wec</span><span class="o">.</span><span class="n">td_to_fd</span><span class="p">(</span><span class="n">cc_power_td</span><span class="p">)</span>

<span class="n">Fe</span> <span class="o">=</span> <span class="n">wec_fdom</span><span class="p">[</span><span class="s1">&#39;excitation_force&#39;</span><span class="p">][:,</span> <span class="n">idof</span><span class="p">]</span>

<span class="c1"># plot</span>
<span class="n">ncases</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">label_cc</span> <span class="o">=</span> <span class="s1">&#39;CC&#39;</span>
<span class="n">label_ps</span> <span class="o">=</span> <span class="s1">&#39;PS&#39;</span>
<span class="n">color_cc</span> <span class="o">=</span> <span class="s1">&#39;tab:blue&#39;</span>
<span class="n">color_ps</span> <span class="o">=</span> <span class="s1">&#39;tab:orange&#39;</span>
<span class="n">color_w</span> <span class="o">=</span> <span class="s1">&#39;0.0&#39;</span>
<span class="n">color_s</span> <span class="o">=</span> <span class="s1">&#39;0.25&#39;</span>
<span class="n">lw</span> <span class="o">=</span> <span class="mi">2</span>

<span class="c1"># Plot time domain</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># plot PS force limits</span>
<span class="n">xlim</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">xlim</span><span class="p">],</span> <span class="p">[</span><span class="n">f_max</span><span class="p">,</span> <span class="n">f_max</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">color_s</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">xlim</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="n">f_max</span><span class="p">,</span> <span class="o">-</span><span class="n">f_max</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">color_s</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">wec_tdom</span><span class="p">[</span><span class="s1">&#39;wave_elevation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color_w</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">)</span>
<span class="n">wec_tdom</span><span class="p">[</span><span class="s1">&#39;excitation_force&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">influenced_dof</span><span class="o">=</span><span class="s1">&#39;HEAVE&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color_w</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wec</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">cc_pos_td</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_cc</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label_cc</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">)</span>
<span class="n">wec_tdom</span><span class="p">[</span><span class="s1">&#39;pos&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">influenced_dof</span><span class="o">=</span><span class="s1">&#39;HEAVE&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color_ps</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label_ps</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wec</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">cc_vel_td</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_cc</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label_cc</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">)</span>
<span class="n">wec_tdom</span><span class="p">[</span><span class="s1">&#39;vel&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">influenced_dof</span><span class="o">=</span><span class="s1">&#39;HEAVE&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color_ps</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label_ps</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wec</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">cc_force_td</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_cc</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label_cc</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">)</span>
<span class="n">pto_tdom</span><span class="p">[</span><span class="s1">&#39;force&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">dof_pto</span><span class="o">=</span><span class="s1">&#39;pto_1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color_ps</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label_ps</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">)</span>  <span class="c1"># marker=&#39;.&#39;</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wec</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">cc_power_td</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_cc</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label_cc</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">)</span>
<span class="n">pto_tdom</span><span class="p">[</span><span class="s1">&#39;power&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">dof_pto</span><span class="o">=</span><span class="s1">&#39;pto_1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color_ps</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label_ps</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">)</span>

<span class="c1"># format subplots</span>
<span class="n">ylims</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">5000.0</span><span class="p">,</span> <span class="mf">500.0</span><span class="p">]</span>
<span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;η [m]&#39;</span><span class="p">,</span> <span class="s1">&#39;Fₑ [N]&#39;</span><span class="p">,</span> <span class="s1">&#39;z [m]&#39;</span><span class="p">,</span> <span class="s1">&#39;u [m/s]&#39;</span><span class="p">,</span>
         <span class="s1">&#39;Fᵤ [N]&#39;</span><span class="p">,</span> <span class="s1">&#39;P [W]&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">ylim</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span> <span class="n">ylims</span><span class="p">,</span> <span class="n">names</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">axs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">label_outer</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)],</span> <span class="n">minor</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.75&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">xlim</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">ylim</span><span class="p">,</span> <span class="o">-</span><span class="n">ylim</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ylim</span><span class="p">],</span> <span class="n">minor</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">ncol</span><span class="o">=</span><span class="n">ncases</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">align_ylabels</span><span class="p">(</span><span class="n">axs</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>


<span class="c1">## Plot frequency domain</span>
<span class="n">omega</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">],</span> <span class="n">wec</span><span class="o">.</span><span class="n">omega</span><span class="p">])</span>
<span class="n">cases</span> <span class="o">=</span> <span class="p">[</span><span class="n">label_cc</span><span class="p">,</span> <span class="n">label_ps</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncases</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="s1">&#39;col&#39;</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="s1">&#39;row&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">plot_fd</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">fdom</span><span class="p">,</span> <span class="n">marker</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">rmface</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">_plot_fd</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">fdom</span><span class="p">,</span> <span class="n">marker</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">rmface</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">markers</span><span class="p">,</span> <span class="n">stems</span><span class="p">,</span> <span class="n">base</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span>
            <span class="n">omega</span><span class="p">,</span>
            <span class="n">fdom</span><span class="p">,</span>
            <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39;k-&#39;</span><span class="p">,</span>
            <span class="n">linefmt</span><span class="o">=</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span>
            <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="o">+</span><span class="n">marker</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
        <span class="n">width</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="n">stems</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="n">width</span><span class="p">)</span>
        <span class="n">base</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="n">width</span><span class="p">)</span>
        <span class="n">markers</span><span class="o">.</span><span class="n">set_markeredgewidth</span><span class="p">(</span><span class="n">width</span><span class="p">)</span>
        <span class="n">markers</span><span class="o">.</span><span class="n">set_markersize</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rmface</span><span class="p">:</span>
            <span class="n">markers</span><span class="o">.</span><span class="n">set_markerfacecolor</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

    <span class="n">omega</span> <span class="o">=</span> <span class="n">omega</span> <span class="o">/</span> <span class="p">(</span><span class="n">wfreq</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
    <span class="n">mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fdom</span><span class="p">),</span>
                     <span class="n">out</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">fdom</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">fdom</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">ang</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">fdom</span><span class="p">))</span>

    <span class="n">_plot_fd</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">omega</span><span class="p">,</span> <span class="n">mag</span><span class="p">,</span> <span class="n">marker</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">rmface</span><span class="p">)</span>
    <span class="n">_plot_fd</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">omega</span><span class="p">,</span> <span class="n">ang</span><span class="p">,</span> <span class="n">marker</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">rmface</span><span class="p">)</span>


<span class="n">iaxs</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">plot_fd</span><span class="p">(</span><span class="n">iaxs</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">Fe</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;Fₑ&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">plot_fd</span><span class="p">(</span><span class="n">iaxs</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">cc_vel_fd</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;u&#39;</span><span class="p">)</span>
<span class="n">plot_fd</span><span class="p">(</span><span class="n">iaxs</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">cc_force_fd</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39;Fᵤ&#39;</span><span class="p">)</span>

<span class="n">iaxs</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">plot_fd</span><span class="p">(</span><span class="n">iaxs</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">Fe</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;Fₑ&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">plot_fd</span><span class="p">(</span><span class="n">iaxs</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">wec_fdom</span><span class="p">[</span><span class="s1">&#39;vel&#39;</span><span class="p">],</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;u&#39;</span><span class="p">)</span>
<span class="n">plot_fd</span><span class="p">(</span><span class="n">iaxs</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">pto_fdom</span><span class="p">[</span><span class="s1">&#39;force&#39;</span><span class="p">],</span> <span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39;Fᵤ&#39;</span><span class="p">)</span>

<span class="c1"># format subplots</span>
<span class="n">locs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
<span class="n">ylims</span> <span class="o">=</span> <span class="p">[</span><span class="mf">100.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">]</span>
<span class="n">xlims</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">omega</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">wfreq</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncases</span><span class="p">):</span>
    <span class="n">iaxs</span> <span class="o">=</span> <span class="n">axs</span> <span class="k">if</span> <span class="n">ncases</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">axs</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
        <span class="n">iaxs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">locs</span><span class="p">,</span> <span class="n">minor</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">iaxs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="o">-</span><span class="n">ylims</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ylims</span><span class="p">[</span><span class="n">j</span><span class="p">]],</span> <span class="n">minor</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">iaxs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">label_outer</span><span class="p">()</span>
        <span class="n">iaxs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.75&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span>
                     <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">)</span>
        <span class="n">iaxs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">)</span>
        <span class="n">iaxs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">iaxs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">iaxs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlims</span><span class="p">)</span>
        <span class="n">iaxs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="s1">&#39;0&#39;</span><span class="p">]</span><span class="o">+</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s1"> ω₀&#39;</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">locs</span><span class="p">])</span>
    <span class="n">iaxs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="s2">&quot;-π&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;π&quot;</span><span class="p">],</span> <span class="n">minor</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">iaxs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">cases</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">iaxs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>
    <span class="n">iaxs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">iaxs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">ncol</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
        <span class="n">iaxs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude [dB]&#39;</span><span class="p">)</span>
        <span class="n">iaxs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Angle [rad]&#39;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">align_ylabels</span><span class="p">(</span><span class="n">iaxs</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/_examples_tutorial_1_wavebot_41_0.png" src="../_images/_examples_tutorial_1_wavebot_41_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/_examples_tutorial_1_wavebot_41_1.png" src="../_images/_examples_tutorial_1_wavebot_41_1.png" />
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../tutorials.html" class="btn btn-neutral float-left" title="Tutorials" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="tutorial_2_wavebot_optimization.html" class="btn btn-neutral float-right" title="Tutorial 2 - WaveBot Optimization" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Copyright 2020 National Technology &amp; Engineering Solutions of Sandia, LLC(NTESS). Under the terms of Contract DE-NA0003525 with NTESS, the U.S. Government retains certain rights in this software..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>